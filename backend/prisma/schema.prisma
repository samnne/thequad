generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  
}

model Listing {
  lid         String   @id @default(uuid()) @db.Uuid
  title       String
  description String
  price       Float
  imageUrls   String[]

  sellerId String @db.Uuid
  seller   User   @relation(fields: [sellerId], references: [uid])
  sold Boolean  @default(false)
  archived Boolean @default(false)
  
  createdAt DateTime @default(now())
}

model User {
  uid          String   @id @default(uuid()) @db.Uuid
  email        String   @unique
  passwordHash String
  name         String
  profileURL   String
  isVerified   Boolean  @default(false)
  createdAt    DateTime @default(now())

  listings      Listing[]
  conversations Conversation[]
}

model Conversation {
  cid   String @id @default(uuid()) @db.Uuid
  title String

  listingId String @db.Uuid

  userUid String? @db.Uuid
  user    User?   @relation(fields: [userUid], references: [uid])

  messages Message[]
}

model Message {
  mid String @id @default(uuid()) @db.Uuid

  text    String
  created DateTime
  read    DateTime?
  edited  Boolean
  updated DateTime

  conversationID String       @db.Uuid
  conversation   Conversation @relation(fields: [conversationID], references: [cid])
}
